{% extends 'admin/layout.html.twig' %}

{% block admin_content %}
<div class="d-flex justify-content-between align-items-center mb-3">
    <h2 class="mb-0">{{ title }}</h2>
    <a class="btn btn-outline-secondary" href="?action=posts">Zpět na přehled</a>
</div>

{% if errors %}
    <div class="alert alert-danger">
        <ul class="mb-0">
            {% for error in errors %}
                <li>{{ error }}</li>
            {% endfor %}
        </ul>
    </div>
{% endif %}

<form method="post" class="row g-3" enctype="multipart/form-data">
    {% if post %}
        <input type="hidden" name="id" value="{{ post.id }}">
    {% endif %}

    <div class="col-12">
        <label class="form-label" for="title">Název</label>
        <input class="form-control" type="text" id="title" name="title" value="{{ post.title ?? '' }}" required>
    </div>

    <div class="col-md-6">
        <label class="form-label" for="post_type_id">Typ obsahu</label>
        <select class="form-select" id="post_type_id" name="post_type_id" required>
            {% for type in post_types %}
                <option value="{{ type.id }}" {% if selected_post_type == type.id %}selected{% endif %}>{{ type.name }}</option>
            {% endfor %}
        </select>
        <div class="form-text">Typy obsahu spravuješ v sekci „Typy obsahu“.</div>
    </div>

    <div class="col-md-6">
        <label class="form-label" for="thumbnail_url">Náhledový obrázek (URL)</label>
        <input class="form-control" type="url" id="thumbnail_url" name="thumbnail_url" value="{{ post.thumbnail_url ?? '' }}" placeholder="https://...">
        <div class="form-text">Zadej kompletní URL k obrázku. Pole je nepovinné.</div>
    </div>

    <div class="col-md-6">
        <label class="form-label" for="thumbnail_upload">Nebo nahraj obrázek</label>
        <input class="form-control" type="file" id="thumbnail_upload" name="thumbnail_upload" accept="image/*">
        <div class="form-text">Obrázek se uloží do struktury <code>uploads/images/Y/m</code> a vyplní URL automaticky.</div>
    </div>

    <div class="col-md-6">
        <label class="form-label" for="categories">Kategorie</label>
        <select class="form-select" id="categories" name="categories[]" multiple size="5">
            {% for category in categories %}
                <option value="{{ category.id }}" {% if category.id in selected_categories %}selected{% endif %}>{{ category.name }}</option>
            {% endfor %}
        </select>
        <div class="form-text">Spravuj dostupné kategorie v sekci „Kategorie“.</div>
    </div>

    <div class="col-md-6">
        <label class="form-label" for="tags">Štítky</label>
        <select class="form-select" id="tags" name="tags[]" multiple size="5">
            {% for tag in tags %}
                <option value="{{ tag.id }}" {% if tag.id in selected_tags %}selected{% endif %}>{{ tag.name }}</option>
            {% endfor %}
        </select>
        <div class="form-text">Štítky pomáhají seřadit obsah. Přidej nové v sekci „Štítky“.</div>
    </div>

    <div class="col-md-6">
        <label class="form-label" for="slug">SEO adresa (slug)</label>
        <input class="form-control" type="text" id="slug" name="slug" value="{{ post.slug ?? '' }}" placeholder="např. super-clanek">
        <div class="form-text">Nevyplněné pole se doplní automaticky z názvu a vynutí se unikátní hodnota.</div>
    </div>

    <div class="col-12">
        <label class="form-label" for="excerpt">Krátký popis</label>
        <textarea class="form-control" id="excerpt" name="excerpt" rows="3" placeholder="Stručný úvod nebo anotace článku">{{ post.excerpt ?? '' }}</textarea>
        <div class="form-text">Používá se jako perex a zobrazuje se ve výpisech.</div>
    </div>

    <div class="col-12">
        <label class="form-label" for="content">Obsah</label>
        <textarea class="form-control" id="content" name="content" rows="10">{{ post.content ?? '' }}</textarea>
    </div>

    <div class="col-12 d-flex justify-content-end">
        <button class="btn btn-success" type="submit">Uložit</button>
    </div>
</form>
{% endblock %}
